<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Working With WebApplicationFactory" /><meta property="og:locale" content="en" /><meta name="description" content="Working with the WebApplicationFactory class to create tests" /><meta property="og:description" content="Working with the WebApplicationFactory class to create tests" /><link rel="canonical" href="https://jrdev.io//posts/Working-With-WebApplicationFactory/" /><meta property="og:url" content="https://jrdev.io//posts/Working-With-WebApplicationFactory/" /><meta property="og:site_name" content="Jr Dev" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-02T00:00:00-06:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Working With WebApplicationFactory" /><meta name="twitter:site" content="@sigfualt" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-03T10:50:24-06:00","datePublished":"2023-02-02T00:00:00-06:00","description":"Working with the WebApplicationFactory class to create tests","headline":"Working With WebApplicationFactory","mainEntityOfPage":{"@type":"WebPage","@id":"https://jrdev.io//posts/Working-With-WebApplicationFactory/"},"url":"https://jrdev.io//posts/Working-With-WebApplicationFactory/"}</script><title>Working With WebApplicationFactory | Jr Dev</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Jr Dev"><meta name="application-name" content="Jr Dev"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://raw.githubusercontent.com/KamRon-67/jrdev.io/master/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Jr Dev</a></div><div class="site-subtitle font-italic">Keeping software simple</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/KamRon-67" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/sigfualt" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['cameronyoung','cmmsolutions.io'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Working With WebApplicationFactory</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Working With WebApplicationFactory</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Cameron Young </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Feb 2, 2023, 12:00 AM -0600" >Feb 2, 2023<i class="unloaded">2023-02-02T00:00:00-06:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Feb 3, 2023, 10:50 AM -0600" >Feb 3, 2023<i class="unloaded">2023-02-03T10:50:24-06:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="768 words">4 min read</span></div></div><div class="post-content"><p>Throughout my career, I have seen the testing pyramid. I was under the impression that one should create more unit tests than integration tests with a dash of UI testing. The first part of my career. I was an automation developer. So, I only did UI testing. After moving back to the formal development side. To my shock many of the places I worked. Testing was not integral to the dev process. Personally, this burned me and added unnecessary stress to my life.</p><p>That was then, now. I test software in ways that help me sleep at night. Later when a bug is found or we need to extend this feature. I noticed zero stress on my side. I can make the changes quickly and possibly improve the logic. The requirements are locked in. Finding myself on the backend of things more than the front end. Integration tests gives me more value as I am creating several moving parts.</p><p>When I first started out testing my software I would tend to blur the lines between unit tests and integration tests. My unit tests may touch a few parts of the system and many would not consider them unit tests any longer. There would not be any calls to a database or service. I would mock the responses. This blurring was a compromise between testing at all and working with a clientâ€™s ci cd process.</p><p>This is when I found out about the WebApplicationFactory class. I was late to the party and probably working on a legacy application. Legacy applications are sometimes my bread and butter. Staying current on new ways to test is best. Then I stumbled onto the WebApplicationFactory.</p><h2 id="how-i-see-it">How I see it</h2><blockquote><p>To me, the WebApplicationFactory class is just an in-memory application that can handle HttpClient, in-memory DBâ€™s it can do more tho.</p></blockquote><p>I am only able to use this with newer projects .net 3 plus. For me, that is not a problem as I want to distance myself from dotnet framework. One can configure test-specific implementations of services. Or override the default behavior in the WebApplicationFactory instance. This opens a TDD lane for me.</p><p>Here is a simple example of using WebApplicationFactory for testing an ASP.NET Core MVC application <a href="https://github.com/DamianEdwards/MinimalApiPlayground"><strong>(Full app here)</strong></a>:</p><div class="language-csharp highlighter-rouge"><div class="code-header" text-data="csharp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">Microsoft.AspNetCore.Mvc.Testing</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.EntityFrameworkCore</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.Extensions.DependencyInjection</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.Extensions.Hosting</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">MinimalApiPlayground.Tests</span><span class="p">;</span>

<span class="k">internal</span> <span class="k">class</span> <span class="nc">PlaygroundApplication</span> <span class="p">:</span> <span class="n">WebApplicationFactory</span><span class="p">&lt;</span><span class="n">Program</span><span class="p">&gt;</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">_environment</span><span class="p">;</span>

    <span class="k">public</span> <span class="nf">PlaygroundApplication</span><span class="p">(</span><span class="kt">string</span> <span class="n">environment</span> <span class="p">=</span> <span class="s">"Development"</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_environment</span> <span class="p">=</span> <span class="n">environment</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">override</span> <span class="n">IHost</span> <span class="nf">CreateHost</span><span class="p">(</span><span class="n">IHostBuilder</span> <span class="n">builder</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">builder</span><span class="p">.</span><span class="nf">UseEnvironment</span><span class="p">(</span><span class="n">_environment</span><span class="p">);</span>

        <span class="c1">// Add mock/test services to the builder here</span>
        <span class="n">builder</span><span class="p">.</span><span class="nf">ConfigureServices</span><span class="p">(</span><span class="n">services</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
            <span class="n">services</span><span class="p">.</span><span class="nf">AddScoped</span><span class="p">(</span><span class="n">sp</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="c1">// Replace SQLite with in-memory database for tests</span>
                <span class="k">return</span> <span class="k">new</span> <span class="n">DbContextOptionsBuilder</span><span class="p">&lt;</span><span class="n">TodoDb</span><span class="p">&gt;()</span>
                <span class="p">.</span><span class="nf">UseInMemoryDatabase</span><span class="p">(</span><span class="s">"Tests"</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">UseApplicationServiceProvider</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
                <span class="p">.</span><span class="n">Options</span><span class="p">;</span>
            <span class="p">});</span>
        <span class="p">});</span>

        <span class="k">return</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateHost</span><span class="p">(</span><span class="n">builder</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><div class="language-csharp highlighter-rouge"><div class="code-header" text-data="csharp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http.Headers</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Xunit</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">MinimalApiPlayground.Tests</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">TodoApi</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">_validTodosJsonFileName</span> <span class="p">=</span> <span class="s">"todos-valid.json"</span><span class="p">;</span>
    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">_invalidTodosJsonFileName</span> <span class="p">=</span> <span class="s">"todos-invalid.json"</span><span class="p">;</span>

    <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">POST_FromFile_Valid_Responds_Created</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">await</span> <span class="k">using</span> <span class="nn">var</span> <span class="n">application</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PlaygroundApplication</span><span class="p">();</span>

        <span class="k">using</span> <span class="nn">var</span> <span class="n">formContent</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MultipartFormDataContent</span><span class="p">();</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">fileContent</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamContent</span><span class="p">(</span><span class="n">File</span><span class="p">.</span><span class="nf">OpenRead</span><span class="p">(</span><span class="n">_validTodosJsonFileName</span><span class="p">));</span>
        <span class="n">fileContent</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="n">MediaTypeHeaderValue</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"application/json"</span><span class="p">);</span>
        <span class="n">formContent</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">fileContent</span><span class="p">,</span> <span class="s">"todosFile"</span><span class="p">,</span> <span class="n">_validTodosJsonFileName</span><span class="p">);</span>

        <span class="k">using</span> <span class="nn">var</span> <span class="n">client</span> <span class="p">=</span> <span class="n">application</span><span class="p">.</span><span class="nf">CreateClient</span><span class="p">();</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="s">"/todos/fromfile"</span><span class="p">,</span> <span class="n">formContent</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

        <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">Created</span><span class="p">,</span> <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">);</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">NotNull</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">Location</span><span class="p">);</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">Matches</span><span class="p">(</span><span class="s">"My Todo from a file"</span><span class="p">,</span> <span class="n">responseBody</span><span class="p">);</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">Matches</span><span class="p">(</span><span class="s">"Another Todo from a file"</span><span class="p">,</span> <span class="n">responseBody</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">POST_FromFile_Invalid_Responds_BadRequest</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">await</span> <span class="k">using</span> <span class="nn">var</span> <span class="n">application</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PlaygroundApplication</span><span class="p">();</span>

        <span class="k">using</span> <span class="nn">var</span> <span class="n">formContent</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MultipartFormDataContent</span><span class="p">();</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">fileContent</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamContent</span><span class="p">(</span><span class="n">File</span><span class="p">.</span><span class="nf">OpenRead</span><span class="p">(</span><span class="n">_invalidTodosJsonFileName</span><span class="p">));</span>
        <span class="n">fileContent</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">ContentType</span> <span class="p">=</span> <span class="n">MediaTypeHeaderValue</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"application/json"</span><span class="p">);</span>
        <span class="n">formContent</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">fileContent</span><span class="p">,</span> <span class="s">"todosFile"</span><span class="p">,</span> <span class="n">_invalidTodosJsonFileName</span><span class="p">);</span>

        <span class="k">using</span> <span class="nn">var</span> <span class="n">client</span> <span class="p">=</span> <span class="n">application</span><span class="p">.</span><span class="nf">CreateClient</span><span class="p">();</span>
        <span class="k">using</span> <span class="nn">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="s">"/todos/fromfile"</span><span class="p">,</span> <span class="n">formContent</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

        <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">BadRequest</span><span class="p">,</span> <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">);</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">ContentType</span><span class="p">,</span> <span class="n">MediaTypeHeaderValue</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"application/problem+json"</span><span class="p">));</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">Matches</span><span class="p">(</span><span class="s">"\\[1\\].Title"</span><span class="p">,</span> <span class="n">responseBody</span><span class="p">);</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">Matches</span><span class="p">(</span><span class="s">"The Title field is required"</span><span class="p">,</span> <span class="n">responseBody</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

</pre></table></code></div></div><p>Well after looking at the miniamal apiâ€™s I had one question. WebApplicationFactory<T> expects an entry-point-class. What do I give it? That was a common question and the answer is here https://stackoverflow.com/questions/69058176/how-to-use-webapplicationfactory-in-net6-without-speakable-entry-point. There was also an answer about how to set this up inconjuction with xunit's IClassFixture.</T></p><p>WebApplicationFactory is a valuable tool for integration testing ASP.NET Core applications. It provides a complete testing environment, including a deployed app and an in-memory server, making it much easier to set up, and run tests.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogging/'>Blogging</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tdd/" class="post-tag no-text-decoration" >TDD</a> <a href="/tags/testing/" class="post-tag no-text-decoration" >Testing</a> <a href="/tags/testing-framework/" class="post-tag no-text-decoration" >Testing Framework</a> <a href="/tags/c/" class="post-tag no-text-decoration" >C#</a> <a href="/tags/webapplicationfactory/" class="post-tag no-text-decoration" >WebApplicationFactory</a> <a href="/tags/xunit/" class="post-tag no-text-decoration" >Xunit</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Working With WebApplicationFactory - Jr Dev&url=https://jrdev.io//posts/Working-With-WebApplicationFactory/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Working With WebApplicationFactory - Jr Dev&u=https://jrdev.io//posts/Working-With-WebApplicationFactory/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Working With WebApplicationFactory - Jr Dev&url=https://jrdev.io//posts/Working-With-WebApplicationFactory/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Clean-Architecture-Take-Away-Part-1/">Clean Architecture Take Away Part 1</a><li><a href="/posts/Working-With-WebApplicationFactory/">Working With WebApplicationFactory</a><li><a href="/posts/Jumping-Into-Testing/">Using Tests To Speed up FeedBack Loop</a><li><a href="/posts/Intro-To-DI-Aggregation-Association-And-Composition/">Intro To DI, Aggregation Association And Composition</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/testing/">Testing</a> <a class="post-tag" href="/tags/aspnet-core/">aspnet core</a> <a class="post-tag" href="/tags/prototype-chain/">Prototype Chain</a> <a class="post-tag" href="/tags/tdd/">TDD</a> <a class="post-tag" href="/tags/testing-framework/">Testing Framework</a> <a class="post-tag" href="/tags/visual-studio/">Visual Studio</a> <a class="post-tag" href="/tags/proto/">__proto__</a> <a class="post-tag" href="/tags/aggregation/">Aggregation</a> <a class="post-tag" href="/tags/api/">API</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/The-T-In-TDD/"><div class="card-body"> <span class="timeago small" >Mar 11, 2021<i class="unloaded">2021-03-11T00:00:00-06:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The T In TDD</h3><div class="text-muted small"><p> By this point. If you have read some of my older blog postings. You know I am a part of a programming group that is big on TDD and the DDD paradigm. My mind is all over the place and I learn 5 thin...</p></div></div></a></div><div class="card"> <a href="/posts/Jumping-Into-Testing/"><div class="card-body"> <span class="timeago small" >Feb 2, 2022<i class="unloaded">2022-02-02T00:00:00-06:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Using Tests To Speed up FeedBack Loop</h3><div class="text-muted small"><p> Why Do I Even Care to Test? I have worked in a few code bases that only had tests at the center layers of the application. The team would rarely touch that code plus there is a good chance the test...</p></div></div></a></div><div class="card"> <a href="/posts/top-shortcuts/"><div class="card-body"> <span class="timeago small" >Nov 12, 2019<i class="unloaded">2019-11-12T00:00:00-06:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>My commonly used shortcuts</h3><div class="text-muted small"><p> Below is a list of my daily drivers. This is a windows short cut that is similar to alt tab but more aesthetically pleasing. This shortcut is just muscle memory from my Linux days. Ctrl tab ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Jumping-Into-Testing/" class="btn btn-outline-primary" prompt="Older"><p>Using Tests To Speed up FeedBack Loop</p></a> <a href="/posts/Coupling-And-Cohesion/" class="btn btn-outline-primary" prompt="Newer"><p>Coupling and Cohesion</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small mb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://jrdev.io//posts/Working-With-WebApplicationFactory/'; this.page.identifier = '/posts/Working-With-WebApplicationFactory/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://jr-dev-1.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (modeToggle !== null) { modeToggle.addEventListener('click', reloadDisqus); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2024 <a href="https://twitter.com/sigfualt">Cameron Young</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/testing/">Testing</a> <a class="post-tag" href="/tags/aspnet-core/">aspnet core</a> <a class="post-tag" href="/tags/prototype-chain/">Prototype Chain</a> <a class="post-tag" href="/tags/tdd/">TDD</a> <a class="post-tag" href="/tags/testing-framework/">Testing Framework</a> <a class="post-tag" href="/tags/visual-studio/">Visual Studio</a> <a class="post-tag" href="/tags/proto/">__proto__</a> <a class="post-tag" href="/tags/aggregation/">Aggregation</a> <a class="post-tag" href="/tags/api/">API</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://jrdev.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-149577567-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-149577567-1'); }); </script>
